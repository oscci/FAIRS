---
title: "FAIRS report 1"
author: "Dorothy Bishop"
date: "2024-12-20"
output: word_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
require(tidyverse)
require(viridis)
require(here)
require(janitor)
```

## Summary of FAIRS Survey, round 1

This is a brief document to provide feedback to panelists from Round 1 of the FAIRS survey.  For background to the survey, please see the protocol here: <https://osf.io/mzjsh/>.  

 

```{r groups, echo=F}
df <- read.csv('dummydata.csv')
myjisc <- read.csv('survey_template.csv')
jisccodes <- seq(4,36,2) #X Codes in JISC file corresponding to items

names(df)<-substring(names(df),1,12) #shorten df names to 12 chars
names(df)[2:3]<-c('ID','group')
df<-clean_names(df)
ncases <- 90
df[1:ncases,1]<-NA

```

```{r simulatedata, echo = F}
#simulate group ID
ngroup <- 3
df$group<-sample(1:ngroup,ncases,replace=TRUE)
df$id<-sample(1001:2000,ncases,replace=FALSE)

#For each item we use the items data to find how many options there are, and what the response range is. We then simulate responses.

njisc<-nrow(myjisc)
for (i in 1:njisc){
  nopt <- myjisc$N.options[i]
  topopt <- myjisc$hirange[i]
  itemcode<-paste0('x',jisccodes[i],'_')
  w<- grep(itemcode,names(df))
  if(nopt>1){
    w<-w[-1] #omit first number if more than one options; first is introtext
  }
  for (ww in w)
    df[,ww]<-sample(1:topopt,ncases,replace=TRUE)
}

#NB for items with single multiple choice, I have simulated with numeric data. These are recorded on JISC file as text, so will need converting

df<-df[order(df$group),] #cluster group members together


```

```{r gatherfreetext, echo=F}
gatherfree <- function(mytext){
  w<-which(!is.na(mytext))
  knitr::kable(mytext[w])
}

```

```{r doroundplot, echo=F}
#Used code from https://bookdown.org/content/b298e479-b1ab-49fa-b83d-a57c2b034d49/part.html#circular-stacked-barchart  
#Now just regular barplot

doround <- function(data,nopt,nitem,df){
  empty_bar <- 2
  nObsType <- nlevels(as.factor(data$response))
  to_add <- data.frame( matrix(NA, empty_bar*nlevels(data$group)*nObsType, ncol(data)) )
  colnames(to_add) <- colnames(data)
  to_add$group <- rep(levels(data$group), each=empty_bar*nObsType )
  data <- rbind(data, to_add)
  data <- data %>% arrange(group)
  data$id <- rep( seq(1, nrow(data)/nObsType) , each=nObsType)
  
  label_data <-aggregate(data$response,by=list(data$item,data$group,data$response),FUN=length,drop=FALSE)
  names(label_data)<-c('item','group','response','count')
  
  nblock <-round(nrow(label_data)/ngroup,0)
  
  #now insert blank rows between groups: this is fiddly!
  range1<-1:nblock
  range2<-nblock+(1:nblock)
  range3<-nblock+range2
  plotdata<-rbind(label_data[range1,],label_data[1,])
  plotdata<-rbind(plotdata,label_data[range2,],label_data[1,])
  plotdata<-rbind(plotdata,label_data[range3,],label_data[1,])
  myrows<-c(range2[1],(1+range3[1]),nrow(plotdata))
  for (k in myrows){
    for (j in 1:ncol(plotdata)){
      plotdata[k,j]<-NA
    }
  }
  plotdata$count[myrows]<-0
  plotdata$group[myrows]<-unique(plotdata$group)
  plotdata$response[myrows]<-1
  plotdata$item[myrows]<-'_'
  plotdata$x <- as.factor(paste0(plotdata$group,"_",plotdata$item))
  label_data$x<-as.factor(paste0(label_data$group,"_",label_data$item))
  #x is variable denoting conjunction of group and item
  
  # create percentage from count
allsum <- aggregate(plotdata$count,by=list(plotdata$x),FUN=sum)
allsum<-allsum[order(allsum$x),]
plotdata$perc<-0
for (ii in 1:nrow(plotdata)){
  w<-which(allsum$Group.1==plotdata$x[ii])
  plotdata$perc[ii] <-100*plotdata$count[ii]/allsum$x[w]
}
    
    
  plotdata$response<-as.factor(plotdata$response)
  
  #Plotting starts here. 
  endx <- (nopt+1) #end xvalue for each group
  p <- ggplot(plotdata) +      
    
    # Add the stacked bar
    
    geom_bar(aes(x=x, y=perc, fill=response), stat="identity", alpha=0.5) +
    scale_fill_viridis(discrete=TRUE) +
    theme_bw() +
    theme(
      #legend.position = "none",
      legend.title=element_text(size=10),
      legend.text=element_text(size=10),
      axis.text = element_blank(),
      axis.title = element_blank(),
      panel.grid = element_blank(),
      #plot.margin = unit(rep(-1,4), "cm") 
    )+
    #crucial to position annotations before convert to polar
    annotate("text",label="Group 1",x=(endx*.6),y = 106)+
    annotate("text",label="Group 2",x=(endx+(endx*.6)),y = 106)+
    annotate("text",label="Group 3",x=(2*endx+(endx*.6)),y = 106)+
    # Add labels on top of each bar - again - do this before polar step
    geom_text(data=label_data, aes(x=x, y=-5, label=item), color="black",size=4) 
  
  # coord_polar()+ 
  # ylim(-20,100)
  filename<-paste0("plot_jiscitem_",i,".png")
  ggsave(p, file=filename, width=8, height=6)
  return()
}


```

```{r makeplots, echo=F}

njisc<-nrow(myjisc)
for (i in 1:njisc){
  nopt <- myjisc$N.options[i]
  itemcode<-paste0('x',jisccodes[i],'_')
  w<- grep(itemcode,names(df))
  if(nopt>1){
    w<-w[-1] #omit first number if more than one options; first is introtext
    
    datax <- df[,c(2,3,w)]
    names(datax)[3:ncol(datax)]<-LETTERS[1:nopt]
    data <- datax %>% gather(key = "item", value="response", -c(1,2)) #long form for this item
    
    p<-doround(data,nopt,nitem, df ) #call plotting function
  }
}

```

```{r maketab, echo=F} 
#tabular output for single option items
maketab <- function(myjisc,itemnum,df){
  jisccodes <- seq(4,36,2) #X Codes in JISC file corresponding to items
    itemcode<-paste0('x',jisccodes[itemnum],'_')
    w<- grep(itemcode,names(df))
    mytab <- table(df[,w],df$group)
    myt <- as.data.frame.matrix(mytab)
    names(myt)<-c('Group1','Group2','Group3')
    ww<-which(names(myjisc)=='introtext')
    rownames(myt)<-myjisc[itemnum,(ww+1):(ww+myjisc$hirange[itemnum])]
    knitr::kable(myt)
}
```

xxx panelists signed up to take part in the survey, and completed surveys were received from `r nrow(df)` of them.  Those taking part were asked to self-identify into one of three groups, and the distribution of respondents was as follows: `r knitr::kable(table(df$group))`. 

*More here on characterstics of panel members from Microsoft doc. *  

For each item in the survey, we show the number of people selecting each response type, prorated to give equal group sizes. Free text comments are also shown. 

## Priorities  
*Item 1*.  
Which of these should be a primary focus for discussion? (1 for low priority, 3 for high priority). Try to avoid selecting the same response for all options, so that we can identify their relative importance.   
- A. What constitutes serious research misconduct?			 
- B. How allegations of serious research misconduct are handled			
- C. Sanctions for serious research misconduct			

![](plot_jiscitem_1.png)  



**Free text comments on item 1**  
`r mytext <- df$x5_1b_opt; gatherfree(mytext)`

## Burdens of serious research misconduct 
*Item 2*.     
How common is the problem of serious research misconduct? (select one)  

- A. Serious research misconduct is rare relative to the amount of published research literature 
- B. Serious research misconduct is becoming more prevalent and starting to pose a threat to the research literature 
- C. Serious research misconduct is already common enough to pose a major threat to the research literature 

`r maketab(myjisc,2,df)`   
**Free text comments on item 2**    

`r mytext <- df$x7_2b_opt; gatherfree(mytext)`   

*Item 3*.   
How harmful are the impacts of serious research misconduct to different segments of society? Please code as 1 (low harm) to 5 (strong harm)  

- A. Consumers of research findings, e.g. patients whose treatment is informed by medical research or policy-makers who depend on research findings					 
- B. Other researchers who try to build on fraudulent findings 
- C. Funders, whose funds are wasted 
- D. Institutions, whose resources are diverted to tackling misconduct 
- E. Society, when public trust in research is eroded 

![](plot_jiscitem_3.png)   

**Free text comments on item 3**    

`r mytext <- df$x9_3b_opt; gatherfree(mytext)`   

## Goals of those responding to serious research misconduct 
*Item 4*.   
In responding to serious research misconduct, several goals may be considered. 
Please rate how important each of these is, from 1 (unimportant) to 4 (very important) 

- A. To maintain academic integrity, including to correct the academic record		 		 
- B. To punish offenders   
- C. To deter others from committing fraud   
- D. To maintain trust and rigour in research   

![](plot_jiscitem_4.png)   
**Free text comments on item 4**    

`r mytext <- df$x11_4b_op; gatherfree(mytext)`   

## Factors hindering academic institutions' response to serious research misconduct 
*Item 5*.   
Various factors may hinder academic institutions' response to serious research 
misconduct. Please rate the following from 1 (not much of a hindrance) to 5 (substantial hindrance) 

- A.Lack of co-ordination between relevant research actors, such as institutions, funders and publishers		
- B. Conflict of interest for institutions investigating their own researchers					 
- C. Lack of resources					 
- D. Lack of expertise					 
- E. Concern about legal repercussions					 
- F. Large number of vexatious/trivial accusations of misconduct					 
- G. Bureaucratic delays or inefficiencies in the investigation process					 
- H. Complexity of cases					 
- I. Due process concerns to ensure fairness to all involved in the case					 

![](plot_jiscitem_5.png)   
**Free text comments on item 5**    

`r mytext <- df$x13_5b_op; gatherfree(mytext)` 	 

## Factors driving serious research misconduct 
**Item 6**   
What is the impact of these factors in encouraging researchers to commit serious research misconduct? 
Please rate from 1 (little impact) to 5 (large impact) 

- A. Low probability of being detected and/or reported 
- B. Low probability of being punished if detected and/or reported 
- C. 'Publish or perish' culture and incentive structure in research (e.g. progression, promotion, recognition)					 
- D. Fear of losing one's job if not sufficiently productive in publishing in prestigious journals 

![](plot_jiscitem_6.png)   
**Free text comments on item 6**    

`r mytext <- df$x15_6b_op; gatherfree(mytext)`  

## Role of social media   
**Item 7**   
On balance, the role of social media in detecting and reporting serious research 
misconduct has been: (select one)  
- A. 	predominantly negative - it makes it too easy for vexatious individuals to raise unwarranted complaints, often under the guise of anonymity   
- B. neither positive nor negative on balance   
- C. positive - it provides a route for speedy commentary when concerns are discovered   

`r maketab(myjisc,7,df)`   

**Free text comments on item 7**    

`r mytext <- df$x17_7b_op; gatherfree(mytext)`  

## Reporting serious research misconduct   
**Item 8**   
Official channels for reporting misconduct are often slow and obstructive (select one option).   
- A. Strongly agree  
- B. Moderately agree  
- C. Neither agree nor disagree  
- D. Moderately disagree  
- E. Strongly disagree  

`r maketab(myjisc,8,df)`   

**Free text comments on item 8**    

`r mytext <- df$x19_8b_op; gatherfree(mytext)`  

## Models for addressing serious research misconduct 
**Item 9**   
In an ideal world where resources are not an issue, which is the most suitable model/system for addressing serious research misconduct? 

- A. Self-regulation approach, where academic institutions are responsible for conducting investigations and 
determining sanctions when one of their staff is accused   
- B. National governance approach, where government regulatory agency is set up for this purpose   
- C. National guidelines approach; for example, UK's Committee for Research Integrity, which does not have a 
regulatory role, but aims to ensure all institutions work to a common framework   
- D. Regulatory agency independent of Government   

![](plot_jiscitem_9.png)   
**Free text comments on item 9**   

`r mytext <- df$x21_9b_op; gatherfree(mytext)` 


